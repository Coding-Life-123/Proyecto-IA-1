<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat IA - Interfaz</title>
    <link rel="stylesheet" href="Style.css" />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <div class="chat-container">
      <div class="chat-header">
        <button class="back-button" onclick="irAEntrada()">
          Ir a la Entrada
        </button>
        <button class="menu-button" onclick="toggleMenu()">
          👥 Lista de Personas
        </button>
        <div class="dropdown-menu" id="dropdownMenu">
          <button class="dropdown-item" onclick="selectPersona('Persona1')">
            👤 Persona 1
          </button>
          <button class="dropdown-item" onclick="selectPersona('Persona2')">
            👤 Persona 2
          </button>
        </div>
      </div>

      <h1 class="chat-title">Chat Automático IA</h1>

      <div class="chat-area">
        <div class="chat-content">
          <div class="chat-placeholder"></div>
        </div>
      </div>

      <div class="buttons-container">
        <button class="chat-button" onclick="iniciarChat()">
          🚀 Iniciar Chat
        </button>
        <button class="chat-button" onclick="reiniciarChat()">
          🔄 Reiniciar Chat
        </button>
      </div>
    </div>

    <!-- Custom Alert Container -->
    <div id="customAlertContainer" class="custom-alert-container">
      <div id="customAlert" class="custom-alert">
        <div class="alert-content">
          <span id="alertIcon" class="alert-icon"></span>
          <div class="alert-text">
            <div id="alertTitle" class="alert-title"></div>
            <div id="alertMessage" class="alert-message"></div>
          </div>
          <button
            type="button"
            class="btn-close"
            onclick="closeCustomAlert()"
            aria-label="Cerrar alerta"
          ></button>
        </div>
      </div>
    </div>

    <script>
      function toggleMenu() {
        const menu = document.getElementById("dropdownMenu");
        const button = document.querySelector(".menu-button");

        menu.classList.toggle("show");
        button.classList.toggle("active");
      }

      function selectPersona(persona) {
        showCustomAlert(
          "info",
          "👤 Persona Seleccionada",
          "Has seleccionado: " +
            persona +
            "\n\nEsta persona ahora puede usar el chat."
        );
        toggleMenu(); // Cierra el menú después de seleccionar
      }

      // Cerrar menú al hacer clic fuera
      document.addEventListener("click", function (event) {
        const menu = document.getElementById("dropdownMenu");
        const button = document.querySelector(".menu-button");

        if (!menu.contains(event.target) && !button.contains(event.target)) {
          menu.classList.remove("show");
          button.classList.remove("active");
        }
      });

      function iniciarChat() {
        // Aquí irá la lógica para iniciar el chat
        showCustomAlert(
          "success",
          "🚀 Chat Iniciado",
          "¡Iniciando chat automático!\n\nEl chat se iniciará en breve..."
        );
      }

      async function reiniciarChat() {
        // Aquí irá la lógica para reiniciar el chat
        const confirmed = await customConfirm(
          "¿Estás seguro de que quieres reiniciar el chat?\n\nSe perderá el historial actual."
        );
        if (confirmed) {
          showCustomAlert(
            "success",
            "🔄 Chat Reiniciado",
            "Chat reiniciado exitosamente!\n\nPuedes comenzar una nueva conversación."
          );
        }
      }

      function irAEntrada() {
        // Función para ir a la página de bienvenida
        window.location.href = "../Bienvenida/Index.html";
      }

      // Custom Alert Functions
      function showCustomAlert(type, title, message) {
        const alertContainer = document.getElementById("customAlertContainer");
        const alert = document.getElementById("customAlert");
        const alertIcon = document.getElementById("alertIcon");
        const alertTitle = document.getElementById("alertTitle");
        const alertMessage = document.getElementById("alertMessage");

        // Set content
        alertTitle.textContent = title;
        alertMessage.textContent = message;

        // Set icon and type
        switch (type) {
          case "success":
            alertIcon.textContent = "✅";
            alert.className = "custom-alert alert-success";
            break;
          case "info":
            alertIcon.textContent = "ℹ️";
            alert.className = "custom-alert alert-info";
            break;
          case "warning":
            alertIcon.textContent = "⚠️";
            alert.className = "custom-alert alert-warning";
            break;
          case "error":
            alertIcon.textContent = "❌";
            alert.className = "custom-alert alert-error";
            break;
          default:
            alertIcon.textContent = "👤";
            alert.className = "custom-alert alert-info";
        }

        // Show alert
        alertContainer.style.display = "flex";
        setTimeout(() => {
          alert.classList.add("show");
        }, 10);
      }

      function closeCustomAlert() {
        const alertContainer = document.getElementById("customAlertContainer");
        const alert = document.getElementById("customAlert");

        alert.classList.remove("show");
        setTimeout(() => {
          alertContainer.style.display = "none";
        }, 300);
      }

      // Custom confirm function
      function customConfirm(message) {
        return new Promise((resolve) => {
          showCustomAlert("warning", "Confirmación", message);

          // Add confirm buttons temporarily
          const alertContent = document.querySelector(".alert-content");
          const existingButtons = alertContent.querySelector(".alert-buttons");
          if (existingButtons) {
            existingButtons.remove();
          }

          const buttonsDiv = document.createElement("div");
          buttonsDiv.className = "alert-buttons";
          buttonsDiv.innerHTML = `
            <button class="btn btn-primary" onclick="handleConfirm(true)">Aceptar</button>
            <button class="btn btn-secondary" onclick="handleConfirm(false)">Cancelar</button>
          `;

          alertContent.appendChild(buttonsDiv);

          window.handleConfirm = (result) => {
            closeCustomAlert();
            resolve(result);
            const buttons = document.querySelector(".alert-buttons");
            if (buttons) buttons.remove();
          };
        });
      }
    </script>
  </body>
</html>
